LOAD [CODICE CLIENTE]  	as CODICE_CLIENTE, 
     [CODICE PR] 		as CODICE_PR,  
     replace([GENERALITA'],chr(39),'\'&chr(39))     as GENERALITA, 
     [DATA INIZIO FORNITURA]	as DATA_INIZIO_FORNITURA, 
     [DATA FINE FORNITURA]		as DATA_FINE_FORNITURA, 
     [PARTITA IVA]			as PARTITA_IVA, 
     [CODICE FISCALE]	as CODICE_FISCALE, 
//     [CODICE REMI], 
//     [CODICE PDM], 
	     PDR_POD as PDR_POD,  
	 ''             as MACROSEGMENTO,     
     [COMMODITY/MACROSEGMENTO/TIPO UTENZA]	as COMMODITY, 
//     [DATA ULTIMA FATTURATA], 
		applymap('map_settimana',[Settimana di fatturazione],'3 Settimana') as SETTIMANA
FROM
[C:\Users\mmenchicchi\OneDrive - pic-informatica.it\Condivisione ENI PIC\RFCF\Insert Into\Excel Utili\Calendario\Middle\FCF - II FCT 2022 - Calendario XEnergy.xlsx]
(ooxml, embedded labels, table is Database)
where not ([CODICE CLIENTE] = '' or isnull([CODICE CLIENTE]) ) ;



tabella_insert:
NoConcatenate
load left(insert,len(insert)-1)&';' as insert
;
load 'insert into lab1_db.rfcf_calendario_xe_forn (CODICE_CLIENTE,CODICE_PR,GENERALITA,DATA_INIZIO_FORNITURA,DATA_FINE_FORNITURA,PARTITA_IVA,CODICE_FISCALE,PDR_POD,MACROSEGMENTO,SETTIMANA) values '&concat(insert)                                                          as insert
;
load
     '('&chr(39)&CODICE_CLIENTE&chr(39)&','&chr(39)&CODICE_PR&chr(39)&','&chr(39)&GENERALITA&chr(39)&','&chr(39)&DATA_INIZIO_FORNITURA&chr(39)&','&chr(39)&DATA_FINE_FORNITURA&chr(39)&','&chr(39)&PARTITA_IVA&chr(39)&','&chr(39)&CODICE_FISCALE&chr(39)&','&chr(39)&PDR_POD&chr(39)&','&chr(39)&MACROSEGMENTO&chr(39)&','&chr(39)&SETTIMANA&chr(39)&'),' as insert
resident EXCEL_XE;

